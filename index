<!DOCTYPE html>
<html lang="th" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Prompt', sans-serif; }
    
    .stat-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }
    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.1);
    }
    
    .bar-animate {
      animation: growBar 1s ease-out forwards;
      transform-origin: left;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .bar-animate:hover {
      filter: brightness(1.1);
    }
    
    @keyframes growBar {
      from { transform: scaleX(0); }
      to { transform: scaleX(1); }
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    .fade-in { animation: fadeInUp 0.5s ease-out forwards; }
    .fade-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
    .fade-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
    .fade-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
    
    .table-row:hover {
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, transparent 100%);
    }

    .login-container { animation: slideInLeft 0.6s ease-out; }
    .clock-display { font-variant-numeric: tabular-nums; letter-spacing: 0.1em; }
    .login-input:focus { box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
    .login-btn { transition: all 0.3s ease; }
    .login-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(79, 70, 229, 0.3);
    }
    .login-btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .error-message { animation: slideInLeft 0.3s ease-out; }
    .login-logo { animation: fadeInUp 0.8s ease-out 0.2s backwards; }
    .login-form { animation: fadeInUp 0.8s ease-out 0.4s backwards; }
    .nav-item { transition: all 0.3s ease; }
    .nav-item.active {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.05) 100%);
      border-left: 4px solid white;
    }
    .form-input { transition: all 0.3s ease; }
    .form-input:focus { box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
    .toast-message { animation: slideInUp 0.3s ease-out; }

    @keyframes slideInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .related-student-row { animation: fadeInUp 0.3s ease-out; }
    .modal-backdrop { animation: fadeInUp 0.3s ease-out; }
  </style>
</head>
<body class="h-full bg-gradient-to-br from-indigo-600 via-purple-600 to-indigo-700 overflow-auto">
  <div id="app" class="w-full h-full flex flex-col">
    
    <div id="login-page" class="w-full h-full flex items-center justify-center px-4">
      <div class="login-container max-w-md w-full">
        <div class="login-logo text-center mb-8">
          <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 rounded-2xl backdrop-blur-xl mb-6 border border-white/30">
            <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z"/>
            </svg>
          </div>
          <h1 class="text-3xl font-bold text-white mb-2">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</h1>
          <p class="text-indigo-200 text-sm">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
        </div>

        <div class="login-form bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl p-8 border border-white/20">
          <form id="login-form" onsubmit="handleLogin(event)">
            <div class="mb-6">
              <label for="username" class="block text-sm font-semibold text-slate-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
              <input type="text" id="username" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required class="login-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:outline-none focus:border-indigo-500 transition-colors">
            </div>
            <div class="mb-6">
              <label for="password" class="block text-sm font-semibold text-slate-700 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
              <input type="password" id="password" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required class="login-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg focus:outline-none focus:border-indigo-500 transition-colors">
            </div>

            <div id="error-message" class="hidden error-message mb-4 p-4 bg-rose-100 border-l-4 border-rose-500 rounded">
              <p class="text-rose-700 text-sm font-medium">üö´ <span id="error-text"></span></p>
            </div>

            <button type="submit" id="login-btn" class="login-btn w-full py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-lg hover:shadow-lg transition-all">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
          </form>

          <div class="mt-6 p-4 bg-indigo-50 rounded-lg border border-indigo-200">
            <p class="text-indigo-700 text-xs font-medium mb-2">üí° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</p>
            <p class="text-indigo-600 text-xs mb-1"><strong>Username:</strong> admin</p>
            <p class="text-indigo-600 text-xs"><strong>Password:</strong> 1234</p>
          </div>
        </div>
      </div>
    </div>

    <div id="dashboard-page" class="hidden w-full flex h-full bg-slate-50">
      
      <aside class="w-64 bg-gradient-to-b from-indigo-700 to-indigo-800 text-white shadow-xl flex flex-col">
        <div class="p-6 border-b border-indigo-600">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm">
              <span id="profile-initial" class="text-lg font-bold">A</span>
            </div>
            <div>
              <p class="font-semibold text-sm" id="profile-name">Admin</p>
              <p class="text-indigo-300 text-xs">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</p>
            </div>
          </div>
        </div>

        <nav class="flex-1 px-3 py-6 space-y-2 overflow-y-auto">
          <button onclick="switchPage('dashboard')" class="nav-item active w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-sm font-medium hover:bg-white/10 transition-colors">
            ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
          </button>
          <button onclick="switchPage('record')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-sm font-medium hover:bg-white/10 transition-colors">
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏™‡πÉ‡∏´‡∏°‡πà
          </button>
          <button onclick="switchPage('cases')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-sm font-medium hover:bg-white/10 transition-colors">
            ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏™
          </button>
          <button onclick="toggleLoginHistory()" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-sm font-medium hover:bg-white/10 transition-colors">
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
          </button>
        </nav>

        <div class="p-4 border-t border-indigo-600">
          <button onclick="handleLogout()" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-sm font-medium bg-white/10 hover:bg-white/20 transition-colors">
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
          </button>
        </div>
      </aside>

      <div class="flex-1 flex flex-col overflow-hidden">
        <header class="bg-white border-b border-slate-200 shadow-sm">
          <div class="px-8 py-4 flex items-center justify-between">
            <div>
              <h1 id="page-title" class="text-2xl font-bold text-slate-800">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h1>
              <p id="semester-info" class="text-slate-500 text-sm">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</p>
            </div>
            <div class="flex items-center gap-6">
              <div class="text-right">
                <div class="clock-display text-2xl font-bold font-mono" id="current-time">00:00:00</div>
                <p class="text-slate-500 text-xs">‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</p>
              </div>
            </div>
          </div>
        </header>

        <main class="flex-1 overflow-auto">
          
          <div id="page-dashboard" class="w-full h-full">
            <section class="max-w-7xl mx-auto px-8 py-8">
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div onclick="filterAndViewCases('all')" class="stat-card bg-white rounded-2xl p-6 shadow-md border border-slate-100 fade-in fade-in-delay-1">
                  <div class="flex items-center justify-between mb-4">
                    <span class="text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded-full">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                  </div>
                  <p class="text-3xl font-bold text-slate-800" id="total-cases">0</p>
                  <p class="text-slate-500 text-sm mt-1">‡πÄ‡∏Ñ‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÄ‡∏ó‡∏≠‡∏°‡∏ô‡∏µ‡πâ</p>
                </div>
                <div onclick="filterAndViewCases('resolved')" class="stat-card bg-white rounded-2xl p-6 shadow-md border border-slate-100 fade-in fade-in-delay-2">
                  <div class="flex items-center justify-between mb-4">
                    <span class="text-xs font-medium text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</span>
                  </div>
                  <p class="text-3xl font-bold text-slate-800" id="resolved-cases">0</p>
                  <p class="text-slate-500 text-sm mt-1">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                </div>
                <div onclick="filterAndViewCases('pending')" class="stat-card bg-white rounded-2xl p-6 shadow-md border border-slate-100 fade-in fade-in-delay-3">
                  <div class="flex items-center justify-between mb-4">
                    <span class="text-xs font-medium text-amber-600 bg-amber-50 px-2 py-1 rounded-full">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span>
                  </div>
                  <p class="text-3xl font-bold text-slate-800" id="pending-cases">0</p>
                  <p class="text-slate-500 text-sm mt-1">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</p>
                </div>
              </div>
            </section>

            <section class="max-w-7xl mx-auto px-8 pb-8">
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-2xl p-6 shadow-md border border-slate-100">
                  <h3 class="text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</h3>
                  <div class="space-y-4" id="behavior-chart"></div>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-md border border-slate-100">
                  <h3 class="text-lg font-semibold text-slate-800 mb-6 flex items-center gap-2">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</h3>
                  <div class="space-y-4" id="grade-chart"></div>
                </div>
              </div>
            </section>
          </div>

          <div id="page-record" class="w-full h-full hidden">
            <section class="max-w-4xl mx-auto px-8 py-8">
              <div class="bg-white rounded-2xl shadow-md border border-slate-100 overflow-hidden">
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-6">
                  <h2 class="text-2xl font-bold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏™‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
                </div>
                <form id="record-form" onsubmit="handleRecordCase(event)" class="p-8 space-y-8">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-slate-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏</label>
                      <input type="date" id="case-date" required class="form-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg">
                    </div>
                  </div>

                  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                      <label class="block text-sm font-semibold text-slate-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                      <input type="text" id="student-name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" required class="form-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg">
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-slate-700 mb-2">‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                      <select id="grade" required class="form-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
                        <option value="‡∏°.1">‡∏°.1</option>
                        <option value="‡∏°.2">‡∏°.2</option>
                        <option value="‡∏°.3">‡∏°.3</option>
                        <option value="‡∏°.4">‡∏°.4</option>
                        <option value="‡∏°.5">‡∏°.5</option>
                        <option value="‡∏°.6">‡∏°.6</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-sm font-semibold text-slate-700 mb-2">‡∏´‡πâ‡∏≠‡∏á</label>
                      <input type="text" id="student-room" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1, 2" required class="form-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg">
                    </div>
                  </div>

                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</label>
                    <select id="behavior-type" required class="form-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg">
                      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° --</option>
                      <option value="relationship">üíï ‡∏ä‡∏π‡πâ‡∏™‡∏≤‡∏ß/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                      <option value="fight">‚öîÔ∏è ‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó</option>
                      <option value="vice">üö¨ ‡∏≠‡∏ö‡∏≤‡∏¢‡∏°‡∏∏‡∏Ç</option>
                      <option value="skip">üèÉ ‡∏´‡∏ô‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                    </select>
                  </div>

                  <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</label>
                    <textarea id="detail" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå..." required class="form-input w-full px-4 py-3 border-2 border-slate-200 rounded-lg resize-none" rows="5"></textarea>
                  </div>

                  <div class="flex gap-4 pt-6">
                    <button type="submit" class="flex-1 px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏™</button>
                    <button type="button" onclick="resetRecordForm()" class="px-6 py-3 bg-slate-200 text-slate-700 font-semibold rounded-lg">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
                  </div>
                </form>

                <div id="record-success" class="hidden toast-message fixed bottom-6 right-6 p-4 bg-emerald-500 text-white rounded-lg shadow-lg">
                  <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏™‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>
                </div>
              </div>
            </section>
          </div>

          <div id="page-cases" class="w-full h-full hidden">
            <section class="max-w-7xl mx-auto px-8 py-8">
              <div class="bg-white rounded-2xl shadow-md border border-slate-100 overflow-hidden">
                <div class="p-6 border-b border-slate-100 bg-slate-50 flex flex-wrap items-center gap-4">
                  <h3 class="text-lg font-semibold text-slate-800">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏™</h3>
                  <div class="flex-1 flex gap-3 justify-end">
                    <select id="filter-type" class="px-4 py-2 border rounded-lg text-sm"><option value="all">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option><option value="relationship">‡∏ä‡∏π‡πâ‡∏™‡∏≤‡∏ß/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</option><option value="fight">‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó</option><option value="vice">‡∏≠‡∏ö‡∏≤‡∏¢‡∏°‡∏∏‡∏Ç</option><option value="skip">‡∏´‡∏ô‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option></select>
                    <select id="filter-grade" class="px-4 py-2 border rounded-lg text-sm"><option value="all">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option><option value="‡∏°.1">‡∏°.1</option><option value="‡∏°.2">‡∏°.2</option><option value="‡∏°.3">‡∏°.3</option><option value="‡∏°.4">‡∏°.4</option><option value="‡∏°.5">‡∏°.5</option><option value="‡∏°.6">‡∏°.6</option></select>
                    <select id="filter-status" class="px-4 py-2 border rounded-lg text-sm"><option value="all">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option><option value="resolved">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option><option value="pending">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option></select>
                  </div>
                </div>
                <div class="overflow-x-auto">
                  <table class="w-full">
                    <thead class="bg-slate-50 border-b border-slate-200">
                      <tr>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏ä‡∏±‡πâ‡∏ô/‡∏´‡πâ‡∏≠‡∏á</th>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th class="text-left px-6 py-4 text-xs font-semibold text-slate-500">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                      </tr>
                    </thead>
                    <tbody id="case-table" class="divide-y divide-slate-100"></tbody>
                  </table>
                </div>
              </div>
            </section>
          </div>
          
        </main>
      </div>
    </div>

    <div id="login-history-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
      <div class="modal-backdrop bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-96 overflow-hidden flex flex-col">
        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-4 flex justify-between">
          <h3 class="text-lg font-semibold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
          <button onclick="toggleLoginHistory()">‡∏õ‡∏¥‡∏î</button>
        </div>
        <div class="overflow-y-auto flex-1">
          <table class="w-full"><tbody id="login-history-table"></tbody></table>
        </div>
      </div>
    </div>

    <div id="case-detail-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-auto">
      <div class="modal-backdrop bg-white rounded-2xl shadow-2xl max-w-2xl w-full my-8">
        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-4 flex justify-between">
          <h3 class="text-lg font-semibold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Ñ‡∏™</h3>
          <button onclick="closeCaseDetail()">‡∏õ‡∏¥‡∏î</button>
        </div>
        <div class="p-6 space-y-6 max-h-96 overflow-y-auto" id="case-detail-content"></div>
        <div class="border-t border-slate-200 p-6 bg-slate-50 flex gap-3">
          <button onclick="toggleCaseStatus()" id="complete-btn" class="flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</button>
          <button onclick="deleteCase()" class="flex-1 px-4 py-2 bg-rose-600 text-white rounded-lg">‡∏•‡∏ö</button>
        </div>
      </div>
    </div>

  </div>

  <script>
    // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ LocalStorage ---
    let allCases = JSON.parse(localStorage.getItem('cases')) || [];
    let loginLogs = JSON.parse(localStorage.getItem('loginLogs')) || [];
    
    function saveToDatabase() {
      localStorage.setItem('cases', JSON.stringify(allCases));
      localStorage.setItem('loginLogs', JSON.stringify(loginLogs));
      updateStatistics();
    }

    const behaviorTypes = [
      { type: 'relationship', label: '‡∏ä‡∏π‡πâ‡∏™‡∏≤‡∏ß/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå', emoji: 'üíï' },
      { type: 'fight', label: '‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏ß‡∏¥‡∏ß‡∏≤‡∏ó', emoji: '‚öîÔ∏è' },
      { type: 'vice', label: '‡∏≠‡∏ö‡∏≤‡∏¢‡∏°‡∏∏‡∏Ç', emoji: 'üö¨' },
      { type: 'skip', label: '‡∏´‡∏ô‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', emoji: 'üèÉ' }
    ];
    const grades = ['‡∏°.1', '‡∏°.2', '‡∏°.3', '‡∏°.4', '‡∏°.5', '‡∏°.6'];

    let currentUser = null;
    let currentCaseDetail = null;
    let currentEditingCaseIndex = null;

    // ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤
    setInterval(() => {
      const now = new Date();
      document.getElementById('current-time').textContent = now.toTimeString().split(' ')[0];
    }, 1000);

    // ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
    function handleLogin(event) {
      event.preventDefault();
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;

      if (user === 'admin' && pass === '1234') {
        currentUser = user;
        loginLogs.push({ username: user, login_time: new Date().toLocaleString(), device_info: navigator.userAgent.substring(0,30), status: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' });
        saveToDatabase();
        
        document.getElementById('login-page').classList.add('hidden');
        document.getElementById('dashboard-page').classList.remove('hidden');
        initDashboard();
      } else {
        document.getElementById('error-message').classList.remove('hidden');
        document.getElementById('error-text').textContent = '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
      }
    }

    function handleLogout() {
      if(confirm('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?')) {
        loginLogs.push({ username: currentUser, login_time: new Date().toLocaleString(), device_info: navigator.userAgent.substring(0,30), status: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö' });
        saveToDatabase();
        location.reload();
      }
    }

    function switchPage(page) {
      ['dashboard', 'record', 'cases'].forEach(p => {
        document.getElementById('page-' + p).classList.add('hidden');
      });
      document.getElementById('page-' + page).classList.remove('hidden');
      
      if(page === 'cases') renderCaseTable(allCases);
    }

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏™
    function handleRecordCase(event) {
      event.preventDefault();
      const newCase = {
        case_date: document.getElementById('case-date').value,
        student_name: document.getElementById('student-name').value,
        grade: document.getElementById('grade').value,
        student_room: document.getElementById('student-room').value,
        behavior_type: document.getElementById('behavior-type').value,
        detail: document.getElementById('detail').value,
        case_status: 'pending'
      };
      
      allCases.push(newCase);
      saveToDatabase();
      
      document.getElementById('record-success').classList.remove('hidden');
      setTimeout(() => document.getElementById('record-success').classList.add('hidden'), 2000);
      resetRecordForm();
    }

    function resetRecordForm() {
      document.getElementById('record-form').reset();
      document.getElementById('case-date').valueAsDate = new Date();
    }

    // ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
    function updateStatistics() {
      document.getElementById('total-cases').textContent = allCases.length;
      document.getElementById('resolved-cases').textContent = allCases.filter(c => c.case_status === 'resolved').length;
      document.getElementById('pending-cases').textContent = allCases.filter(c => c.case_status === 'pending').length;
      
      renderBehaviorChart();
      renderGradeChart();
    }

    function renderBehaviorChart() {
      const container = document.getElementById('behavior-chart');
      container.innerHTML = behaviorTypes.map(bt => {
        const count = allCases.filter(c => c.behavior_type === bt.type).length;
        const width = allCases.length ? (count / allCases.length) * 100 : 0;
        return `
          <div class="flex items-center gap-4">
            <div class="w-32 text-sm">${bt.emoji} ${bt.label}</div>
            <div class="flex-1 h-6 bg-slate-100 rounded"><div class="h-full bg-indigo-500 rounded" style="width: ${width}%"></div></div>
            <span class="text-sm font-bold">${count}</span>
          </div>`;
      }).join('');
    }

    function renderGradeChart() {
      const container = document.getElementById('grade-chart');
      container.innerHTML = grades.map(g => {
        const count = allCases.filter(c => c.grade === g).length;
        const width = allCases.length ? (count / allCases.length) * 100 : 0;
        return `
          <div class="flex items-center gap-4">
            <div class="w-12 text-sm">${g}</div>
            <div class="flex-1 h-6 bg-slate-100 rounded"><div class="h-full bg-purple-500 rounded" style="width: ${width}%"></div></div>
            <span class="text-sm font-bold">${count}</span>
          </div>`;
      }).join('');
    }

    // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏™
    function renderCaseTable(data) {
      const tbody = document.getElementById('case-table');
      tbody.innerHTML = data.map((item, index) => `
        <tr class="border-b">
          <td class="px-6 py-3 text-sm">${item.case_date}</td>
          <td class="px-6 py-3 font-medium">${item.student_name}</td>
          <td class="px-6 py-3 text-sm">${item.grade}/${item.student_room}</td>
          <td class="px-6 py-3 text-sm">${behaviorTypes.find(b=>b.type===item.behavior_type)?.label || ''}</td>
          <td class="px-6 py-3 text-sm truncate max-w-xs">${item.detail}</td>
          <td class="px-6 py-3">${item.case_status === 'resolved' ? '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‚è≥ ‡∏£‡∏≠'}</td>
          <td class="px-6 py-3">
            <button onclick="openCaseDetail(${index})" class="text-indigo-600 text-sm">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
          </td>
        </tr>
      `).join('');
    }

    // ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    function filterData() {
      let filtered = [...allCases];
      const t = document.getElementById('filter-type').value;
      const g = document.getElementById('filter-grade').value;
      const s = document.getElementById('filter-status').value;
      
      if(t !== 'all') filtered = filtered.filter(c => c.behavior_type === t);
      if(g !== 'all') filtered = filtered.filter(c => c.grade === g);
      if(s !== 'all') filtered = filtered.filter(c => c.case_status === s);
      
      renderCaseTable(filtered);
    }
    
    document.getElementById('filter-type').addEventListener('change', filterData);
    document.getElementById('filter-grade').addEventListener('change', filterData);
    document.getElementById('filter-status').addEventListener('change', filterData);

    // ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏™ (‡∏î‡∏π, ‡∏•‡∏ö, ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞)
    function openCaseDetail(index) {
      currentEditingCaseIndex = index;
      currentCaseDetail = allCases[index];
      const c = currentCaseDetail;
      
      document.getElementById('case-detail-content').innerHTML = `
        <p><strong>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong> ${c.student_name} (${c.grade}/${c.student_room})</p>
        <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${c.case_date}</p>
        <p><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong> ${c.detail}</p>
        <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${c.case_status}</p>
      `;
      document.getElementById('case-detail-modal').classList.remove('hidden');
    }

    function closeCaseDetail() {
      document.getElementById('case-detail-modal').classList.add('hidden');
    }

    function toggleCaseStatus() {
      if(currentCaseDetail) {
        currentCaseDetail.case_status = currentCaseDetail.case_status === 'resolved' ? 'pending' : 'resolved';
        saveToDatabase();
        closeCaseDetail();
        if(document.getElementById('page-cases').classList.contains('hidden') === false) filterData();
      }
    }

    function deleteCase() {
      if(confirm('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?')) {
        allCases.splice(currentEditingCaseIndex, 1);
        saveToDatabase();
        closeCaseDetail();
        filterData();
      }
    }

    // ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
    function toggleLoginHistory() {
      const modal = document.getElementById('login-history-modal');
      modal.classList.toggle('hidden');
      if(!modal.classList.contains('hidden')) {
        document.getElementById('login-history-table').innerHTML = loginLogs.slice().reverse().map(l => `
          <tr class="border-b"><td class="p-3">${l.username}</td><td class="p-3">${l.login_time}</td><td class="p-3">${l.status}</td></tr>
        `).join('');
      }
    }

    function initDashboard() {
      document.getElementById('case-date').valueAsDate = new Date();
      updateStatistics();
    }
  </script>
</body>
</html>
